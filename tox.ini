[tox]

envlist =
    py3, docs-{linux, win32}
skipsdist = true

[testenv]
passenv = *
allowlist_externals = *
isolated_build = true
platform =
    linux: linux
    win32: win32
basepython = python3
recreate = false

deps =
    poetry >= 1.3.2

commands =
    poetry install


[testenv:tests]

commands =
    poetry install --with dev
    poetry run coverage run -m pytest .
    poetry run coverage report -m


[testenv:docs-win32]
commands =
    poetry install --with docs
    .\docs\\make.bat clean
    .\docs\\make.bat html



[testenv:docs-linux]
changedir = docs
commands =
    poetry install --with docs
    poetry run sphinx-apidoc -f -o source/ ../ ../tests/
    make clean
    make html
